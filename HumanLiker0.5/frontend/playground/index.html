<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tiger.Humanizer Playground</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050814;
      --bg-soft: #0b1024;
      --card: #10162b;
      --border: #222b4a;
      --accent: #8b5cf6;
      --accent-soft: rgba(139, 92, 246, 0.25);
      --accent-strong: rgba(139, 92, 246, 0.7);
      --ok: #2dd4bf;
      --warn: #fbbf24;
      --err: #f87171;
      --text: #eef3ff;
      --muted: #95a2c5;
      --shadow: 0 26px 80px rgba(0, 0, 0, 0.75);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Inter", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 55%, #000 100%);
      color: var(--text);
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 32px 20px;
    }

    .shell {
      width: 100%;
      max-width: 1240px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-pill {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background:
        radial-gradient(circle at 30% 0, #22d3ee 0, rgba(34, 211, 238, 0) 60%),
        radial-gradient(circle at 70% 100%, #8b5cf6 0, rgba(139, 92, 246, 0) 60%);
      box-shadow:
        0 0 0 1px rgba(148, 163, 184, 0.35),
        0 0 32px rgba(59, 130, 246, 0.55);
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .title-block h1 {
      margin: 0;
      font-size: 20px;
      letter-spacing: 0.04em;
    }

    .title-block p {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
    }

    .toggles {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      font-size: 12px;
      color: var(--muted);
    }

    .toggle span {
      width: 8px;
      height: 8px;
      border-radius: 999px;
    }

    .toggle span.is-on {
      background: var(--ok);
      box-shadow: 0 0 12px rgba(45, 212, 191, 0.9);
    }

    .toggle span.is-off {
      background: rgba(148, 163, 184, 0.5);
    }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.3fr);
      gap: 18px;
    }

    .panel {
      background: radial-gradient(circle at top left, #111827 0, #020617 55%);
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: var(--shadow);
      padding: 16px 16px 18px;
      position: relative;
      overflow: hidden;
    }

    .panel::before {
      content: "";
      position: absolute;
      inset: -40%;
      opacity: 0.35;
      background:
        radial-gradient(circle at 0 0, rgba(34, 211, 238, 0.14) 0, transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(139, 92, 246, 0.18) 0, transparent 55%);
      pointer-events: none;
    }

    .panel-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .panel-header h2 {
      margin: 0;
      font-size: 15px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: rgba(226, 232, 240, 0.92);
    }

    .pill {
      border-radius: 999px;
      padding: 3px 9px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 14px var(--accent-soft);
    }

    label {
      font-size: 12px;
      color: var(--muted);
      display: block;
      margin-bottom: 4px;
    }

    select,
    input[type="text"],
    input[type="datetime-local"],
    textarea {
      width: 100%;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.45);
      background: rgba(15, 23, 42, 0.85);
      color: var(--text);
      padding: 8px 10px;
      font-size: 13px;
      outline: none;
    }

    textarea {
      min-height: 150px;
      resize: vertical;
    }

    select:focus,
    input:focus,
    textarea:focus {
      border-color: var(--accent);
      box-shadow:
        0 0 0 1px rgba(129, 140, 248, 0.35),
        0 0 36px rgba(79, 70, 229, 0.4);
    }

    .field-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .chip {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.45);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
    }

    .chip.is-active {
      border-color: var(--accent);
      color: var(--text);
      background: radial-gradient(circle at 0 0, rgba(34, 211, 238, 0.15) 0, transparent 55%),
                  radial-gradient(circle at 100% 100%, rgba(139, 92, 246, 0.25) 0, transparent 60%);
    }

    .actions {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-top: 6px;
    }

    .btn-primary {
      border-radius: 999px;
      border: 0;
      padding: 9px 18px;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      background: radial-gradient(circle at 0 0, #22d3ee 0, #0ea5e9 50%, #6366f1 100%);
      color: #0b1024;
      box-shadow:
        0 0 0 1px rgba(148, 163, 184, 0.3),
        0 16px 36px rgba(59, 130, 246, 0.7);
      cursor: pointer;
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow:
        0 0 0 1px rgba(148, 163, 184, 0.3),
        0 10px 24px rgba(59, 130, 246, 0.6);
    }

    .btn-ghost {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: transparent;
      color: var(--muted);
      padding: 7px 14px;
      font-size: 12px;
      cursor: pointer;
    }

    .btn-ghost span {
      font-size: 11px;
      opacity: 0.8;
    }

    .hint {
      font-size: 11px;
      color: var(--muted);
    }

    /* Right side: pipeline + results */

    .pipeline-card {
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: linear-gradient(120deg, rgba(17, 24, 39, 0.9), rgba(15, 23, 42, 0.9));
      padding: 10px 10px 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .pipeline-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .pipeline-header span {
      font-size: 11px;
      color: var(--muted);
    }

    .pipeline-steps {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 6px;
    }

    .step {
      position: relative;
      border-radius: 999px;
      padding: 4px 8px;
      font-size: 11px;
      text-align: center;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: var(--muted);
    }

    .step::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at 50% 0, rgba(34, 211, 238, 0.22) 0, transparent 60%);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.18s ease-out;
    }

    .step.is-active {
      border-color: var(--accent);
      color: var(--text);
    }

    .step.is-active::before {
      opacity: 1;
    }

    .pipeline-energy {
      position: relative;
      height: 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 1);
      overflow: hidden;
      border: 1px solid rgba(15, 23, 42, 1);
    }

    .pipeline-energy-fill {
      position: absolute;
      inset: 0;
      width: 24%;
      border-radius: inherit;
      background:
        linear-gradient(90deg, rgba(56, 189, 248, 0.05), rgba(56, 189, 248, 0.9), rgba(129, 140, 248, 0.9));
      box-shadow: 0 0 24px rgba(56, 189, 248, 0.9);
      transform: translateX(0%);
      transition: transform 0.4s ease-out, width 0.4s ease-out;
    }

    .pipeline-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .pipeline-status {
      font-size: 11px;
      color: var(--muted);
    }

    .badge {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      padding: 2px 8px;
      font-size: 11px;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent-soft);
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    .result-card {
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: radial-gradient(circle at 0 0, rgba(34, 211, 238, 0.16) 0, transparent 60%),
                  radial-gradient(circle at 100% 100%, rgba(139, 92, 246, 0.18) 0, transparent 70%),
                  #020617;
      padding: 10px 10px 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .result-label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.09em;
    }

    .result-body {
      font-size: 13px;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .log-card {
      margin-top: 10px;
      border-radius: 14px;
      border: 1px dashed rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.9);
      padding: 8px 10px;
      max-height: 140px;
      overflow: auto;
      font-size: 11px;
      color: var(--muted);
    }

    .log-line {
      margin-bottom: 2px;
      white-space: pre;
    }

    @media (max-width: 960px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
      }

      body {
        padding: 18px 12px 28px;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <header class="header">
      <div class="brand">
        <div class="brand-pill"></div>
        <div class="title-block">
          <h1>Tiger.Humanizer Playground</h1>
          <p>
            String · Numbers · Dates · Collections – bridged to HumanLiker v0.5
            backend.
          </p>
        </div>
      </div>
      <div class="toggles">
        <div class="toggle" id="modeToggle">
          <span class="is-on" id="modeDot"></span>
          <span id="modeLabel">Mock engine</span>
        </div>
        <div class="toggle">
          <span class="is-on"></span>
          <span>Live preview</span>
        </div>
      </div>
    </header>

    <main class="grid">
      <!-- Left: input -->
      <section class="panel">
        <div class="panel-inner">
          <div class="panel-header">
            <h2>Input</h2>
            <div class="pill">
              <span class="pill-dot"></span>
              HUMANIZE REQUEST
            </div>
          </div>

          <div class="field-row">
            <div>
              <label for="kind">Mode</label>
              <select id="kind">
                <option value="string">String</option>
                <option value="number">Number</option>
                <option value="datetime">DateTime</option>
                <option value="timespan">TimeSpan</option>
                <option value="collection">Collection</option>
                <option value="enum">Enum</option>
              </select>
            </div>
            <div>
              <label for="culture">Culture</label>
              <select id="culture">
                <option value="en-US">en-US</option>
                <option value="en-GB">en-GB</option>
                <option value="fr-FR">fr-FR</option>
                <option value="es-ES">es-ES</option>
              </select>
            </div>
          </div>

          <div>
            <label for="payload">Value</label>
            <textarea
              id="payload"
              placeholder="Type a string, a number, a date/time, or a comma-separated list depending on the selected mode..."
            ></textarea>
          </div>

          <div class="field-row">
            <div>
              <label>Preset</label>
              <div class="chips" id="presetBar">
                <button type="button" class="chip" data-preset="pascal">
                  PascalCase → sentence
                </button>
                <button type="button" class="chip" data-preset="relative">
                  Now ± TimeSpan
                </button>
                <button type="button" class="chip" data-preset="quantity">
                  ToQuantity
                </button>
              </div>
            </div>
            <div>
              <label>Hints</label>
              <p class="hint">
                Use presets to quickly load sample inputs, then edit them freely.
              </p>
            </div>
          </div>

          <div class="actions">
            <button class="btn-ghost" type="button" id="clearBtn">
              Clear
            </button>
            <button class="btn-primary" type="button" id="runBtn">
              Run Humanizer
            </button>
          </div>
        </div>
      </section>

      <!-- Right: pipeline + results -->
      <section class="panel">
        <div class="panel-inner">
          <div class="panel-header">
            <h2>Pipeline &amp; Output</h2>
            <div class="pill">
              <span class="pill-dot"></span>
              BEST EFFORT HUMANIZATION
            </div>
          </div>

          <div class="pipeline-card">
            <div class="pipeline-header">
              <span>Processing pipeline</span>
              <span id="pipelineModeLabel">Idle</span>
            </div>
            <div class="pipeline-steps">
              <div class="step" data-step="parse">Parse</div>
              <div class="step" data-step="analyze">Analyze</div>
              <div class="step" data-step="transform">Transform</div>
              <div class="step" data-step="format">Format</div>
            </div>
            <div class="pipeline-energy">
              <div class="pipeline-energy-fill" id="energyFill"></div>
            </div>
            <div class="pipeline-footer">
              <div class="pipeline-status" id="pipelineStatus">
                Waiting for input.
              </div>
              <div class="badge">
                <span class="badge-dot"></span>
                <span id="engineLabel">Mock engine · local</span>
              </div>
            </div>
          </div>

          <div class="results-grid">
            <article class="result-card">
              <div class="result-label">Original</div>
              <div class="result-body" id="originalOut">—</div>
            </article>
            <article class="result-card">
              <div class="result-label">Humanized</div>
              <div class="result-body" id="humanizedOut">—</div>
            </article>
            <article class="result-card">
              <div class="result-label">Reverse / Extra</div>
              <div class="result-body" id="reverseOut">—</div>
            </article>
          </div>

          <div class="log-card" id="log">
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const kindEl = document.getElementById("kind");
    const cultureEl = document.getElementById("culture");
    const payloadEl = document.getElementById("payload");
    const presetBar = document.getElementById("presetBar");
    const clearBtn = document.getElementById("clearBtn");
    const runBtn = document.getElementById("runBtn");

    const originalOut = document.getElementById("originalOut");
    const humanizedOut = document.getElementById("humanizedOut");
    const reverseOut = document.getElementById("reverseOut");

    const pipelineStatus = document.getElementById("pipelineStatus");
    const pipelineModeLabel = document.getElementById("pipelineModeLabel");
    const energyFill = document.getElementById("energyFill");
    const steps = Array.from(document.querySelectorAll(".step"));

    const modeToggle = document.getElementById("modeToggle");
    const modeDot = document.getElementById("modeDot");
    const modeLabel = document.getElementById("modeLabel");
    const engineLabel = document.getElementById("engineLabel");

    const logEl = document.getElementById("log");

    const API_BASE =
      window.location.hostname === "localhost" && window.location.port === "8080"
        ? "http://localhost:3000"
        : "";

    let useMock = false;
    let pipelineTimer = null;

    function backendLabel() {
      return `${API_BASE || window.location.origin}/api/humanizer/playground`;
    }

    if (!useMock) {
      modeDot.classList.remove("is-on");
      modeDot.classList.add("is-off");
      modeLabel.textContent = "Try backend";
    }

    function log(line) {
      const div = document.createElement("div");
      div.className = "log-line";
      const now = new Date().toISOString().split("T")[1].slice(0, 8);
      div.textContent = `[${now}] ${line}`;
      logEl.prepend(div);
    }

    function setPipelineState(state) {
      if (state === "idle") {
        steps.forEach((s) => s.classList.remove("is-active"));
        energyFill.style.transform = "translateX(0%)";
        energyFill.style.width = "24%";
        pipelineStatus.textContent = "Waiting for input.";
        pipelineModeLabel.textContent = "Idle";
        return;
      }

      if (state === "done") {
        steps.forEach((s) => s.classList.add("is-active"));
        energyFill.style.transform = "translateX(0%)";
        energyFill.style.width = "100%";
        pipelineStatus.textContent =
          "Selected output is now pinned as the humanized version.";
        pipelineModeLabel.textContent = "Complete";
        return;
      }
    }

    function animatePipeline() {
      if (pipelineTimer) {
        clearInterval(pipelineTimer);
      }
      const orderedSteps = ["parse", "analyze", "transform", "format"];
      let idx = 0;
      steps.forEach((s) => s.classList.remove("is-active"));
      energyFill.style.width = "24%";
      energyFill.style.transform = "translateX(0%)";
      pipelineStatus.textContent = "Running mock processing pipeline…";
      pipelineModeLabel.textContent = useMock ? "Mock" : "Backend";

      pipelineTimer = setInterval(() => {
        if (idx >= orderedSteps.length) {
          clearInterval(pipelineTimer);
          setPipelineState("done");
          return;
        }
        const current = orderedSteps[idx];
        steps.forEach((s) => {
          s.classList.toggle("is-active", s.dataset.step === current);
        });
        const fraction = (idx + 1) / orderedSteps.length;
        energyFill.style.width = `${20 + fraction * 80}%`;
        energyFill.style.transform = `translateX(${(fraction - 1) * 10}%)`;
        idx += 1;
      }, 260);
    }

    function applyPreset(preset) {
      if (preset === "pascal") {
        kindEl.value = "string";
        payloadEl.value =
          "PascalCaseInputStringIsTurnedIntoSentenceCaseByTigerHumanizer";
        log("Preset loaded: PascalCase → sentence");
      } else if (preset === "relative") {
        kindEl.value = "datetime";
        payloadEl.value = "now - 2h";
        log("Preset loaded: relative DateTime example.");
      } else if (preset === "quantity") {
        kindEl.value = "number";
        payloadEl.value = "file | 0,1,2,5";
        log("Preset loaded: ToQuantity sweep.");
      }
    }

    function mockHumanize(kind, culture, value) {
      const trimmed = (value || "").trim();
      if (!trimmed) {
        return {
          original: "—",
          humanized: "No input provided.",
          reverse: "Provide a value on the left to see the pipeline in action."
        };
      }

      if (kind === "string") {
        return {
          original: trimmed,
          humanized:
            "Pascal case input string is turned into sentence case by tiger humanizer.",
          reverse: "Reverse example: PascalCaseInputStringIsTurnedIntoSentenceCaseByTigerHumanizer"
        };
      }

      if (kind === "number") {
        return {
          original: trimmed,
          humanized: "2 files · 5 tasks · 12 messages (auto‑pluralized)",
          reverse: "WordsToNumber example: "one hundred and two" → 102"
        };
      }

      if (kind === "datetime") {
        return {
          original: trimmed,
          humanized: "2 hours ago · yesterday · tomorrow (relative time)",
          reverse: "Ordinal words example: 1st January 2015 / January 1st, 2015"
        };
      }

      if (kind === "timespan") {
        return {
          original: trimmed,
          humanized: "2 weeks, 3 days (precision: 2)",
          reverse: "ToAge example: 18 years"
        };
      }

      if (kind === "collection") {
        return {
          original: trimmed,
          humanized: "Alice, Bob, and Charlie",
          reverse: "Oxford comma collection formatter."
        };
      }

      if (kind === "enum") {
        return {
          original: trimmed,
          humanized: "Member without description attribute",
          reverse: "DehumanizeTo<UserType>() can map this back to an enum value."
        };
      }

      return {
        original: trimmed,
        humanized: "Not sure how to humanize this yet.",
        reverse: ""
      };
    }

    async function run() {
      const kind = kindEl.value;
      const culture = cultureEl.value;
      const value = payloadEl.value;

      log(`Run requested – kind=${kind}, culture=${culture}.`);
      animatePipeline();

      if (useMock) {
        const result = mockHumanize(kind, culture, value);
        originalOut.textContent = result.original;
        humanizedOut.textContent = result.humanized;
        reverseOut.textContent = result.reverse;
      } else {
        try {
          const res = await fetch(`${API_BASE}/api/humanizer/playground`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ kind, culture, value })
          });
          if (!res.ok) {
            const errorData = await res.json().catch(() => ({}));
            throw new Error(`HTTP ${res.status}: ${errorData.error || res.statusText}`);
          }
          const data = await res.json();
          originalOut.textContent = data.original ?? value;
          humanizedOut.textContent = data.humanized ?? "—";
          reverseOut.textContent = data.reverse ?? "";
          log("Backend responded successfully.");
        } catch (err) {
          log("Backend error – falling back to mock description.");
          const result = mockHumanize(kind, culture, value);
          originalOut.textContent = result.original;
          humanizedOut.textContent = result.humanized;
          reverseOut.textContent = result.reverse;
        }
      }
    }

    modeToggle.addEventListener("click", () => {
      useMock = !useMock;
      if (useMock) {
        modeDot.classList.add("is-on");
        modeDot.classList.remove("is-off");
        modeLabel.textContent = "Mock engine";
        engineLabel.textContent = "Mock engine · local";
        log("Switched to mock engine mode.");
      } else {
        modeDot.classList.remove("is-on");
        modeDot.classList.add("is-off");
        modeLabel.textContent = "Try backend";
        engineLabel.textContent = `Backend · ${backendLabel()}`;
        log(`Switched to backend mode (expects API route at ${backendLabel()}).`);
      }
    });

    presetBar.addEventListener("click", (evt) => {
      const btn = evt.target.closest("[data-preset]");
      if (!btn) return;
      const preset = btn.dataset.preset;
      applyPreset(preset);
    });

    clearBtn.addEventListener("click", () => {
      payloadEl.value = "";
      originalOut.textContent = "—";
      humanizedOut.textContent = "—";
      reverseOut.textContent = "—";
      setPipelineState("idle");
      log("Cleared current input and output.");
    });

    runBtn.addEventListener("click", () => {
      run();
    });

    // initial state
    setPipelineState("idle");
    engineLabel.textContent = useMock
      ? "Mock engine · local"
      : `Backend · ${backendLabel()}`;
    log("Playground ready. Choose a mode, type a value, and run Humanizer.");
  </script>
</body>
</html>
